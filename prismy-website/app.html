<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRISMY - Translate</title>
    <style>
        /* Monochrome Color System */
        :root {
            /* Grayscale Palette */
            --color-bg: #FAFAFA;           /* Very light gray background */
            --color-white: #FFFFFF;         /* Pure white */
            --color-gray-50: #F9FAFB;       /* Almost white */
            --color-gray-100: #F3F4F6;      /* Light gray */
            --color-gray-200: #E5E7EB;      /* Border gray */
            --color-gray-300: #D1D5DB;      /* Medium light gray */
            --color-gray-400: #9CA3AF;      /* Placeholder gray */
            --color-gray-500: #6B7280;      /* Medium gray */
            --color-gray-600: #4B5563;      /* Dark gray */
            --color-gray-700: #374151;      /* Darker gray */
            --color-gray-800: #1F2937;      /* Very dark gray */
            --color-gray-900: #111827;      /* Almost black */
            --color-black: #000000;         /* Pure black */
            
            /* Primary accent (minimal use) */
            --color-primary: #18181B;       /* Near black for primary actions */
            
            /* Typography */
            --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            
            /* Font Sizes */
            --text-xs: 0.75rem;     /* 12px */
            --text-sm: 0.875rem;    /* 14px */
            --text-base: 1rem;      /* 16px */
            --text-lg: 1.125rem;    /* 18px */
            --text-xl: 1.25rem;     /* 20px */
            --text-2xl: 1.5rem;     /* 24px */
            
            /* Spacing */
            --space-1: 0.25rem;     /* 4px */
            --space-2: 0.5rem;      /* 8px */
            --space-3: 0.75rem;     /* 12px */
            --space-4: 1rem;        /* 16px */
            --space-5: 1.25rem;     /* 20px */
            --space-6: 1.5rem;      /* 24px */
            --space-8: 2rem;        /* 32px */
            
            /* Shadows - Subtle and sophisticated */
            --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            
            /* Transitions */
            --transition-all: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-transform: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-opacity: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-shadow: box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Base */
        html {
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: var(--font-family);
            font-size: var(--text-base);
            line-height: 1.5;
            color: var(--color-gray-700);
            background-color: var(--color-bg);
            height: 100vh;
            overflow: hidden;
        }

        /* App Layout */
        .app {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Header */
        .header {
            background: var(--color-white);
            border-bottom: 1px solid var(--color-gray-200);
            box-shadow: var(--shadow-xs);
            z-index: 1000;
        }

        .header-content {
            height: 64px;
            padding: 0 var(--space-6);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* Logo */
        .logo {
            font-size: var(--text-xl);
            font-weight: 600;
            letter-spacing: -0.025em;
            color: var(--color-gray-900);
            text-decoration: none;
            transition: var(--transition-opacity);
        }

        .logo:hover {
            opacity: 0.7;
        }

        /* Header Actions */
        .header-actions {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        /* Translation Mode Tabs */
        .mode-tabs {
            display: flex;
            background: var(--color-gray-100);
            border-radius: 8px;
            padding: 2px;
        }

        .mode-tab {
            padding: var(--space-2) var(--space-4);
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--color-gray-600);
            background: transparent;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition-all);
        }

        .mode-tab.active {
            background: var(--color-white);
            color: var(--color-gray-900);
            box-shadow: var(--shadow-sm);
        }

        /* Translation Container */
        .translation-container {
            flex: 1;
            display: flex;
            background: var(--color-bg);
            overflow: hidden;
        }

        /* Translation Panel */
        .panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--color-white);
            margin: var(--space-6);
            max-width: 600px;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            transition: var(--transition-shadow);
        }

        /* Center panels */
        .translation-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: var(--space-6);
            background: var(--color-bg);
            overflow: hidden;
            padding: var(--space-8) var(--space-6);
        }

        /* Text area font size */
        .text-area {
            width: 100%;
            min-height: 100%;
            font-family: inherit;
            font-size: var(--text-base);
            line-height: 1.6;
            color: var(--color-gray-900);
            background: transparent;
            border: none;
            resize: none;
            outline: none;
        }

        .panel:hover {
            box-shadow: var(--shadow-xl);
        }

        .panel + .panel {
            margin-left: 0;
        }

        /* Language Bar */
        .language-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-4) var(--space-6);
            background: var(--color-gray-50);
            border-bottom: 1px solid var(--color-gray-200);
        }

        .language-select-wrapper {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .language-label {
            font-size: var(--text-sm);
            color: var(--color-gray-500);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .language-select {
            appearance: none;
            background: var(--color-white);
            border: 1px solid var(--color-gray-300);
            border-radius: 8px;
            padding: var(--space-2) var(--space-3);
            padding-right: var(--space-8);
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--color-gray-800);
            cursor: pointer;
            transition: var(--transition-all);
            background-image: url("data:image/svg+xml,%3Csvg width='10' height='6' viewBox='0 0 10 6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L5 5L9 1' stroke='%236B7280' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
        }

        .language-select:hover {
            border-color: var(--color-gray-400);
        }

        .language-select:focus {
            outline: none;
            border-color: var(--color-gray-600);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.05);
        }

        /* Swap Button */
        .swap-button {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 48px;
            height: 48px;
            background: var(--color-white);
            border: 1px solid var(--color-gray-200);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-all);
            box-shadow: var(--shadow-md);
            z-index: 10;
        }

        .swap-button:hover {
            background: var(--color-gray-900);
            border-color: var(--color-gray-900);
            transform: translate(-50%, -50%) scale(1.05);
            box-shadow: var(--shadow-lg);
        }

        .swap-button:hover svg {
            stroke: var(--color-white);
        }

        .swap-button svg {
            width: 20px;
            height: 20px;
            stroke: var(--color-gray-600);
            stroke-width: 2;
            transition: var(--transition-all);
        }

        /* Text Area */
        .text-area-wrapper {
            flex: 1;
            padding: var(--space-6);
            overflow-y: auto;
        }

        .text-area {
            width: 100%;
            min-height: 100%;
            font-family: inherit;
            font-size: var(--text-lg);
            line-height: 1.6;
            color: var(--color-gray-900);
            background: transparent;
            border: none;
            resize: none;
            outline: none;
        }

        .text-area::placeholder {
            color: var(--color-gray-400);
        }

        .text-area:read-only {
            cursor: default;
        }

        /* Toolbar */
        .toolbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-4) var(--space-6);
            background: var(--color-gray-50);
            border-top: 1px solid var(--color-gray-200);
        }

        .toolbar-actions {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        /* Button */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-2) var(--space-4);
            font-size: var(--text-sm);
            font-weight: 500;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            text-decoration: none;
            transition: var(--transition-all);
            white-space: nowrap;
        }

        .btn-icon {
            width: 36px;
            height: 36px;
            padding: 0;
            border-radius: 50%;
        }

        .btn-ghost {
            color: var(--color-gray-700);
            background: transparent;
        }

        .btn-ghost:hover {
            background: var(--color-gray-200);
        }

        .btn-primary {
            color: var(--color-white);
            background: var(--color-gray-900);
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            background: var(--color-black);
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        /* Icons */
        .icon {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        /* Status */
        .status {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: var(--text-sm);
            color: var(--color-gray-500);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--color-gray-400);
            transition: var(--transition-all);
        }

        .status-dot.active {
            background: var(--color-gray-900);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Character Counter */
        .char-counter {
            font-size: var(--text-sm);
            color: var(--color-gray-500);
        }

        .char-counter.warning {
            color: var(--color-gray-700);
            font-weight: 500;
        }

        /* Loading */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid var(--color-gray-200);
            border-radius: 50%;
            border-top-color: var(--color-gray-700);
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Divider */
        .divider {
            position: relative;
            width: 1px;
            background: var(--color-gray-200);
            margin: var(--space-4) 0;
        }

        /* User Menu */
        .user-menu {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-2) var(--space-3);
            border-radius: 100px;
            cursor: pointer;
            transition: var(--transition-all);
        }

        .user-menu:hover {
            background: var(--color-gray-100);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--color-gray-300);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--color-gray-600);
        }

        /* Pro Badge */
        .pro-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-1);
            padding: var(--space-1) var(--space-2);
            background: var(--color-gray-900);
            color: var(--color-white);
            font-size: var(--text-xs);
            font-weight: 600;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        /* Info Banner */
        .info-banner {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3) var(--space-4);
            background: var(--color-gray-100);
            border-radius: 8px;
            margin-bottom: var(--space-3);
            font-size: var(--text-sm);
            color: var(--color-gray-700);
        }

        .info-banner svg {
            width: 16px;
            height: 16px;
            stroke: var(--color-gray-600);
            flex-shrink: 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .translation-container {
                flex-direction: column;
            }

            .panel {
                margin: var(--space-2);
            }

            .panel + .panel {
                margin-left: var(--space-2);
                margin-top: 0;
            }

            .swap-button {
                top: auto;
                bottom: -24px;
                left: 50%;
                transform: translateX(-50%);
            }

            .divider {
                width: 100%;
                height: 1px;
                margin: 0 var(--space-4);
            }

            .mode-tabs {
                display: none;
            }
        }

        /* Focus States */
        :focus {
            outline: none;
        }

        :focus-visible {
            outline: 2px solid var(--color-gray-400);
            outline-offset: 2px;
        }

        /* Selection */
        ::selection {
            background: var(--color-gray-900);
            color: var(--color-white);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--color-gray-100);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--color-gray-300);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--color-gray-400);
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <a href="/" class="logo" style="display: flex; align-items: center; gap: 8px;">
                    <img src="logo.png" alt="PRISMY Logo" style="height: 24px; width: auto;">
                    <span>PRISMY</span>
                </a>
                
                <div class="header-actions">
                    <!-- Translation Mode Tabs -->
                    <div class="mode-tabs">
                        <button class="mode-tab active" onclick="setMode('quick')">Quick</button>
                        <button class="mode-tab" onclick="setMode('long')">
                            Long Text
                            <span class="pro-badge">PRO</span>
                        </button>
                        <button class="mode-tab" onclick="setMode('document')">Documents</button>
                    </div>

                    <button class="btn btn-ghost">History</button>
                    <button class="btn btn-ghost">Settings</button>
                    
                    <div class="user-menu">
                        <div class="user-avatar">U</div>
                        <svg class="icon" width="16" height="16" viewBox="0 0 24 24">
                            <path d="M6 9l6 6 6-6"/>
                        </svg>
                    </div>
                </div>
            </div>
        </header>

        <!-- Translation Container -->
        <div class="translation-container">
            <!-- Source Panel -->
            <div class="panel">
                <div class="language-bar">
                    <div class="language-select-wrapper">
                        <span class="language-label">From</span>
                        <select class="language-select" id="sourceLanguage">
                            <option value="auto">Detect language</option>
                            <option value="en">English</option>
                            <option value="vi">Vietnamese</option>
                            <option value="zh">Chinese</option>
                            <option value="ja">Japanese</option>
                            <option value="ko">Korean</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="es">Spanish</option>
                            <option value="th">Thai</option>
                            <option value="id">Indonesian</option>
                        </select>
                    </div>
                </div>

                <div class="text-area-wrapper">
                    <!-- Info Banner for Long Text Mode -->
                    <div class="info-banner" id="longTextInfo" style="display: none;">
                        <svg viewBox="0 0 24 24">
                            <path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span>Long text mode supports up to 20,000 words per translation</span>
                    </div>

                    <textarea 
                        class="text-area"
                        id="sourceText"
                        placeholder="Type, paste, or drop text here..."
                        onkeyup="handleTextInput()"
                    ></textarea>
                </div>

                <div class="toolbar">
                    <div class="toolbar-actions">
                        <button class="btn btn-icon btn-ghost" onclick="startVoiceInput()" title="Voice input">
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3zM19 10v2a7 7 0 0 1-14 0v-2M12 19v4m-4 0h8"/>
                            </svg>
                        </button>
                        <button class="btn btn-icon btn-ghost" onclick="document.getElementById('fileInput').click()" title="Upload file">
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                        </button>
                        <button class="btn btn-icon btn-ghost" onclick="clearText()" title="Clear">
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                        <input type="file" id="fileInput" style="display: none;" accept=".txt,.doc,.docx,.pdf" onchange="handleFileUpload(event)">
                    </div>
                    <div class="char-counter" id="charCounter">0 / 5,000</div>
                </div>
            </div>

            <!-- Swap Button -->
            <button class="swap-button" onclick="swapLanguages()" title="Swap languages">
                <svg viewBox="0 0 24 24" fill="none">
                    <path d="M7 16V4m0 0L3 8m4-4l4 4m6-4v12m0 0l4-4m-4 4l-4-4"/>
                </svg>
            </button>

            <!-- Divider (mobile only) -->
            <div class="divider"></div>

            <!-- Target Panel -->
            <div class="panel">
                <div class="language-bar">
                    <div class="language-select-wrapper">
                        <span class="language-label">To</span>
                        <select class="language-select" id="targetLanguage">
                            <option value="vi">Vietnamese</option>
                            <option value="en">English</option>
                            <option value="zh">Chinese</option>
                            <option value="ja">Japanese</option>
                            <option value="ko">Korean</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="es">Spanish</option>
                            <option value="th">Thai</option>
                            <option value="id">Indonesian</option>
                        </select>
                    </div>
                </div>

                <div class="text-area-wrapper">
                    <textarea 
                        class="text-area"
                        id="targetText"
                        placeholder="Translation will appear here..."
                        readonly
                    ></textarea>
                </div>

                <div class="toolbar">
                    <div class="status" id="status">
                        <span class="status-dot"></span>
                        <span id="statusText">Ready</span>
                    </div>
                    <div class="toolbar-actions">
                        <button class="btn btn-icon btn-ghost" onclick="copyTranslation()" title="Copy">
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                        </button>
                        <button class="btn btn-icon btn-ghost" onclick="downloadTranslation()" title="Download">
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                            </svg>
                        </button>
                        <button class="btn btn-icon btn-ghost" onclick="speakTranslation()" title="Listen">
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"/>
                            </svg>
                        </button>
                        <button class="btn btn-primary" onclick="translateText()" id="translateBtn">
                            Translate
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_URL = 'https://web-production-87be0.up.railway.app';
        let translationTimeout;
        let currentTranslation = '';
        let currentMode = 'quick';
        let maxChars = 5000;
        let maxWords = 20000;

        // Set translation mode
        function setMode(mode) {
            currentMode = mode;
            
            // Update tab styles
            document.querySelectorAll('.mode-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.closest('.mode-tab').classList.add('active');
            
            // Update UI based on mode
            const sourceText = document.getElementById('sourceText');
            const charCounter = document.getElementById('charCounter');
            const longTextInfo = document.getElementById('longTextInfo');
            const translateBtn = document.getElementById('translateBtn');
            
            if (mode === 'quick') {
                maxChars = 5000;
                charCounter.style.display = 'block';
                longTextInfo.style.display = 'none';
                translateBtn.style.display = 'none';
                sourceText.placeholder = 'Type, paste, or drop text here...';
                updateCharCounter();
            } else if (mode === 'long') {
                maxChars = 100000; // ~20k words
                charCounter.style.display = 'block';
                longTextInfo.style.display = 'block';
                translateBtn.style.display = 'inline-flex';
                sourceText.placeholder = 'Paste your long text here (up to 20,000 words)...';
                updateCharCounter();
            } else if (mode === 'document') {
                charCounter.style.display = 'none';
                longTextInfo.style.display = 'none';
                translateBtn.style.display = 'inline-flex';
                sourceText.placeholder = 'Upload a document or paste text from your file...';
            }
        }

        // Update character counter
        function updateCharCounter() {
            const text = document.getElementById('sourceText').value;
            const counter = document.getElementById('charCounter');
            const count = text.length;
            const wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;
            
            if (currentMode === 'quick') {
                counter.textContent = `${count} / ${maxChars.toLocaleString()}`;
                if (count > maxChars * 0.8) {
                    counter.classList.add('warning');
                } else {
                    counter.classList.remove('warning');
                }
            } else if (currentMode === 'long') {
                counter.textContent = `${wordCount.toLocaleString()} / ${maxWords.toLocaleString()} words`;
                if (wordCount > maxWords * 0.8) {
                    counter.classList.add('warning');
                } else {
                    counter.classList.remove('warning');
                }
            }
        }

        // Handle text input
        function handleTextInput() {
            const text = document.getElementById('sourceText').value;
            updateCharCounter();
            
            // Check limits
            if (currentMode === 'quick') {
                if (text.length > maxChars) {
                    document.getElementById('sourceText').value = text.substring(0, maxChars);
                    return;
                }
            } else if (currentMode === 'long') {
                const wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;
                if (wordCount > maxWords) {
                    updateStatus('Text exceeds 20,000 words limit', false);
                    return;
                }
            }
            
            // Auto translate for quick mode
            if (currentMode === 'quick') {
                // Clear previous timeout
                clearTimeout(translationTimeout);
                
                if (text.trim()) {
                    updateStatus('Typing...', false);
                    translationTimeout = setTimeout(() => translateText(), 500);
                } else {
                    document.getElementById('targetText').value = '';
                    updateStatus('Ready', false);
                }
            }
        }

        // Translate text
        async function translateText() {
            const sourceText = document.getElementById('sourceText').value;
            const sourceLang = document.getElementById('sourceLanguage').value;
            const targetLang = document.getElementById('targetLanguage').value;
            
            if (!sourceText.trim()) return;
            
            updateStatus('Translating...', true);
            
            try {
                // For now, use a simple translation simulation
                // Replace this with your actual API endpoint when ready
                
                // Simulate API delay
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Simple translation simulation
                const translations = {
                    'vi': {
                        'hello': 'xin chào',
                        'thank you': 'cảm ơn',
                        'goodbye': 'tạm biệt',
                        'how are you': 'bạn khỏe không',
                        'default': '[VI] '
                    },
                    'en': {
                        'xin chào': 'hello',
                        'cảm ơn': 'thank you',
                        'tạm biệt': 'goodbye',
                        'default': '[EN] '
                    }
                };
                
                // Simple translation logic
                let translatedText = sourceText;
                const targetTranslations = translations[targetLang];
                
                if (targetTranslations) {
                    const lowerText = sourceText.toLowerCase();
                    let found = false;
                    
                    for (const [key, value] of Object.entries(targetTranslations)) {
                        if (key !== 'default' && lowerText.includes(key)) {
                            translatedText = sourceText.toLowerCase().replace(key, value);
                            found = true;
                            break;
                        }
                    }
                    
                    if (!found) {
                        translatedText = targetTranslations.default + sourceText;
                    }
                }
                
                currentTranslation = translatedText;
                document.getElementById('targetText').value = currentTranslation;
                updateStatus('Done', false);
                
                // Uncomment below when you have a working API endpoint
                /*
                const response = await fetch(`${API_URL}/api/v1/translate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        text: sourceText,
                        source_lang: sourceLang,
                        target_lang: targetLang
                    })
                });

                if (!response.ok) {
                    throw new Error('Translation failed');
                }

                const data = await response.json();
                currentTranslation = data.translated_text || translatedText;
                document.getElementById('targetText').value = currentTranslation;
                updateStatus('Done', false);
                */
            } catch (error) {
                console.error('Translation error:', error);
                // Fallback translation
                currentTranslation = `[${targetLang.toUpperCase()}] ${sourceText}`;
                document.getElementById('targetText').value = currentTranslation;
                updateStatus('Done', false);
            }
        }

        // Update status
        function updateStatus(text, active) {
            document.getElementById('statusText').textContent = text;
            const dot = document.querySelector('.status-dot');
            if (active) {
                dot.classList.add('active');
            } else {
                dot.classList.remove('active');
            }
        }

        // Clear text
        function clearText() {
            document.getElementById('sourceText').value = '';
            document.getElementById('targetText').value = '';
            updateCharCounter();
            updateStatus('Ready', false);
        }

        // Swap languages
        function swapLanguages() {
            const sourceLang = document.getElementById('sourceLanguage');
            const targetLang = document.getElementById('targetLanguage');
            const sourceText = document.getElementById('sourceText');
            const targetText = document.getElementById('targetText');
            
            // Don't swap if source is auto-detect
            if (sourceLang.value === 'auto') {
                return;
            }
            
            // Swap language selections
            const tempLang = sourceLang.value;
            sourceLang.value = targetLang.value;
            targetLang.value = tempLang;
            
            // Swap text content
            const tempText = sourceText.value;
            sourceText.value = targetText.value;
            targetText.value = tempText;
            
            // Update and translate
            handleTextInput();
        }

        // Copy translation
        function copyTranslation() {
            const text = document.getElementById('targetText').value;
            if (text) {
                navigator.clipboard.writeText(text);
                
                // Show feedback
                const originalText = document.getElementById('statusText').textContent;
                updateStatus('Copied!', false);
                setTimeout(() => updateStatus(originalText, false), 2000);
            }
        }

        // Download translation
        function downloadTranslation() {
            const text = document.getElementById('targetText').value;
            if (text) {
                const blob = new Blob([text], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'translation_' + new Date().getTime() + '.txt';
                a.click();
                window.URL.revokeObjectURL(url);
            }
        }

        // Text to speech
        function speakTranslation() {
            const text = document.getElementById('targetText').value;
            const targetLang = document.getElementById('targetLanguage').value;
            
            if (text && 'speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                
                const langMap = {
                    'vi': 'vi-VN',
                    'en': 'en-US',
                    'zh': 'zh-CN',
                    'ja': 'ja-JP',
                    'ko': 'ko-KR',
                    'fr': 'fr-FR',
                    'de': 'de-DE',
                    'es': 'es-ES',
                    'th': 'th-TH',
                    'id': 'id-ID'
                };
                
                utterance.lang = langMap[targetLang] || 'en-US';
                speechSynthesis.speak(utterance);
            }
        }

        // Voice input
        function startVoiceInput() {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                const sourceLang = document.getElementById('sourceLanguage').value;
                
                recognition.continuous = false;
                recognition.interimResults = true;
                recognition.lang = sourceLang === 'auto' ? 'en-US' : sourceLang;
                
                recognition.onstart = function() {
                    updateStatus('Listening...', true);
                };
                
                recognition.onresult = function(event) {
                    let transcript = '';
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        transcript += event.results[i][0].transcript;
                    }
                    document.getElementById('sourceText').value = transcript;
                    handleTextInput();
                };
                
                recognition.onerror = function(event) {
                    updateStatus('Error', false);
                };
                
                recognition.onend = function() {
                    updateStatus('Ready', false);
                };
                
                recognition.start();
            } else {
                alert('Speech recognition is not supported in your browser');
            }
        }

        // File upload
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                // Switch to document mode
                setMode('document');
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('sourceText').value = e.target.result;
                    handleTextInput();
                };
                reader.readAsText(file);
                
                updateStatus(`Loaded: ${file.name}`, false);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus('Ready', false);
            updateCharCounter();
            
            // Check if there's demo text from landing page
            const demoText = sessionStorage.getItem('demoText');
            if (demoText) {
                document.getElementById('sourceText').value = demoText;
                sessionStorage.removeItem('demoText');
                handleTextInput();
            }
        });    });

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + Enter to translate
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                if (currentMode !== 'quick') {
                    translateText();
                }
            }
            
            // Ctrl/Cmd + S to swap languages
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                swapLanguages();
            }
        });
    </script>
</body>
</html>